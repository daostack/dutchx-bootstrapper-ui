<template>
  <div class="animated-page au-animate">
    <header network.to-view="networkName"></header>

    <banner></banner>

    <div
      ref="dashboardElement"
      class="dashboard-main-content"
    >

      <div class="dashboard-header">
        <pageloading
          if.bind="loading"
          icononly="true"
          class="main-spinner"
        ></pageloading>
        <img
          else
          class="logo"
          src="../../static/dutchx-blue.svg"
        />
        <div class="title">Welcome to the DutchX Initializer</div>
      </div>

      <div class="propositionsSection">
        <div class="row">
          <div class="col-md-4 proposition">
            <div class="icon"><img src="../../static/icon-better-way-to-trade.svg" /></div>

            <div class="title first">A Better Way To Trade</div>

            <div class="body">
              The DutchX is a fully decentralized trading protocol utilizing the Dutch auction principle to mitigate
              many harmful trading practices such as frontrunning, low liquidity, and third party risk.
            </div>
          </div>
          <div class="col-md-4 proposition">
            <div class="icon"><img src="../../static/icon-completely-decentralized.svg" /></div>

            <div class="title second">Completely Decentralized</div>

            <div class="body">A community DAO gives traders, market makers, and members the unique ability to govern
              the DutchX,
              allowing them to list tokens, manage fees, update the protocol, and more!</div>
          </div>
          <div class="col-md-4 proposition">
            <div class="icon"><img src="../../static/icon-holographic-governance.svg" /></div>

            <div class="title third">Holographic Governance</div>

            <div class="body">Holographic consensus enables the DAO to easily scale, onboarding more traders,
              liquidity providers, and protocol hackers to its trading ecosystem.</div>
          </div>
        </div>
      </div>

      <div class="initializationSection">
        <div class="row">
          <div class="col-8 offset-2">
            <div class="title">The Initialization Phase</div>
            <div class="body">
              <div class="body">To launch the DutchX DAO there needs to be an initial allocation of user
                reputation which will accord decision-making voting power.
                Over the course of the next three months anyone will be able to participate and
                receive reputation in four ways, by:</div>
              <div class="list-items">
                <div class="list-item"><span class="bullet">1</span>Locking Tokens</div>
                <div class="list-item"><span class="bullet">2</span>Locking ETH</div>
                <div class="list-item"><span class="bullet">3</span>Linking locked MGN tokens</div>
                <div class="list-item"><span class="bullet">4</span>Bidding for reputation with DAOstack GEN tokens</div>
              </div>

              <div class="box">The initialization phase will end on ${lockingPeriodEndDate | date:'friendly'}.
                All locked ETH or tokens will be automatically unlocked, and reputation will be automatically redeemed and distributed.</div>
            </div>
          </div>
        </div>
      </div>

      <div if.bind="avatarLoaded">
        <div class="schemesSection">
          <div if.bind="!schemesLoaded">
            <pageloading></pageloading>
          </div>
          <div else>
            <div
              class="row justify-content-around"
              id="accordion_arc_schemes"
              role="tablist"
              show.bind="dutchXSchemes.length"
            >
              <div
                class="col-12 col-md-4"
                style="min-width: 25rem"
              >
                <div class="body">How would you like to obtain reputation in DutchX?</div>
                <ul class="list-group clean dashboard-schemes">
                  <li
                    class="list-group-item"
                    repeat.for="scheme of dutchXSchemes"
                  >
                    <div
                      class="scheme-use-button"
                      data-toggle="collapse"
                      data-target="#${scheme.name}"
                      aria-expanded="false"
                      aria-controls="#${scheme.name}"
                    >
                      <div class="row">
                        <div
                          class="col-1"
                          style="padding-left:0;padding-right:0"
                        >
                          <div class="scheme-icon">
                            <img
                              class="not-selected"
                              src.one-time="dutchXSchemeConfigs.get(scheme.name).icon"
                            />
                            <img
                              class="selected"
                              src.one-time="dutchXSchemeConfigs.get(scheme.name).icon_hover"
                            />
                          </div>
                        </div>
                        <div
                          class="col-4"
                          style="white-space:nowrap; padding-top:.25rem;"
                        >
                          <div class="scheme-name">
                            ${scheme.friendlyName}
                          </div>
                        </div>
                        <div
                          class="col-6"
                          style="text-align:center; white-space:nowrap; padding-top: .25rem;"
                        >
                          <div
                            if.to-view="dutchXSchemeConfigs.get(scheme.name).hasActiveLocks && scheme.numLocks"
                            class="scheme-name activeLocks"
                          >${scheme.numLocks} active locks</div>
                          <div else>&nbsp;</div>
                        </div>
                        <div
                          class="col-1"
                          style="text-align:right;padding-left:0;padding-right:0"
                        >
                          <div class="scheme-name">
                            <div style="display:inline-block; width:100%; text-align: right;">
                              <div class="scheme-arrow-down"><span class="material-icons">keyboard_arrow_down</span></div>
                              <div class="scheme-arrow-up"><span class="material-icons">keyboard_arrow_up</span></div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                    <div
                      id.bind="scheme.name"
                      class="scheme-dashboard collapse"
                      data-parent="#accordion_arc_schemes"
                    >
                      <compose
                        view-model.bind="getDashboardView(scheme)"
                        model.bind="schemeDashboardViewModel(scheme)"
                      ></compose>
                    </div>
                  </li>
                </ul>
              </div>
              <div class="col-12 col-md-5">
                <div class="pie-chart">
                  <div class="body">Initial Reputation Allocation</div>
                  <div class="chart">
                    <img src="../../static/ds_dutchx_pie_chart_01-1.svg" />
                    <div style="text-align:center">Participants may be part of more than one group, and may participate multiple times in each group, with reputation accumulating additively.</div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="redeemSection">
          <div class="row">
            <div class="col-6 offset-3">
              <div class="title">Reputation Distribution</div>
              <div class="body">
                <div if.to-view="canRedeem">
                  The DutchX initialization phase ended on ${lockingPeriodEndDate | date:'friendly'}.
                </div>
                <div else>
                  When the DutchX initialization phase ends, the total amount of reputation you have earned will be
                  transferred to the ETH address you used to submit the locks.
                </div>
              </div>
              <div class="redeemables">
                <!-- <button id="globalRedeemBtn" class="btn btn-outline-secondary" disabled.bind="!canRedeem"
                  click.delegate="redeem()">Redeem</button> -->
                <div if.bind="canRedeem && totalUserReputationEarned.eq(0)">You have not earned any reputation</div>
                <div if.bind="canRedeem && totalUserReputationEarned.gt(0)">
                  <div class="title">Reputation You Have Earned</div>
                  <div class="body">
                    <div class="breakdown">
                      <div
                        class="redeemable"
                        repeat.for="redeemable of redeemables"
                      >
                        <span>${redeemable.amount | ethwei}</span> REP from ${redeemable.what}
                      </div>
                    </div>
                    <div>
                      This amounts to ${totalUserReputationEarned | ethwei}, or
                      ${percentUserReputationEarned}%, of the ${totalReputationAvailable |
                      ethwei} total REP that will be distributed in the initialization phase.
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <footer if.bind="avatarLoaded"></footer>
    </div>
</template>
