<template>
  <div
    class="pageloader"
    if.to-view="!loaded"
  >
    <pageloading></pageloading>
  </div>
  <div else>
    <instructions if.to-view="!auctionIsOver">You can receive reputation by bidding GEN tokens. There will be 10 auctions, each will run for 9 days
      and offer 10,000 REP. The DutchX DAO will receive all the GEN collected in the auctions. To participate all you
      need to do is enter the amount of GEN you wish to bid and click "Bid". The reputation will be distributed pro
      rata once the auction is complete.
    </instructions>

    <div
      class="pageloader scheme-dashboard-body"
      id="auctionDashboardSwitchingSpinner"
      show.to-view="_switchingAuctions"
    >
      <pageloading>Thanks for waiting while we fetch data for the next auction...</pageloading>
    </div>

    <div
      show.to-view="!_switchingAuctions"
      ref="dashboard"
      class="scheme-dashboard-body"
    >

      <div
        class="message"
        if.to-view="auctionNotBegun"
      >The initialization period has not yet begun, you can't yet bid</div>
      <div
        class="message"
        if.to-view="auctionIsOver"
      >The initialization period has ended</div>

      <div
        class="message"
        style="text-align: left"
        if.to-view="!auctionNotBegun && !auctionIsOver"
      >
        <div>Current auction: ${currentAuctionNumber} of ${auctionCount}</div>
        <div>Time left: ${msRemainingInAuctionCountdown | timespan:"seconds"}</div>
      </div>

      <form if.bind="!auctionNotBegun && !auctionIsOver">
        <div class="row">
          <div class="col-5">
            <div class="form-group bmd-form-group">
              <label for="bidAmount">Tokens to bid</label>
              <numeric-input
                css="form-control"
                id="bidAmount"
                value.bind="bidAmount | ethwei"
              ></numeric-input>
            </div>
            <div class="form-group">
              <spinbutton
                disabled.bind="bidding"
                onclick.call="bid()"
                css="btn-submit btn-sm"
                as-button="true"
                text="Bid"
                spin.to-view="bidding"
                title.to-view="bidding ? 'Submitting bid...' : 'Submit Bid'"
              ></spinbutton>
            </div>
          </div>
        </div>
      </form>

      <div if.to-view="!auctionNotBegun">
        <div style="padding-left: .5rem; padding-right: .5rem">
          <div
            class="inline"
            style="font-weight: 500;"
          >Your GEN Bids</div>
          <div class="pull-right">
            <spinbutton
              onclick.call="getAccountBids()"
              class="locksRefreshButton"
              spin.to-view="refreshingBids"
              title="Refresh Bids List"
            ></spinbutton>
          </div>
        </div>

        <table class="table locksForRep">
          <thead class="thead-light">
            <tr>
              <th>Auction #</th>
              <th>You Have Bid</th>
              <th>Total Bid</th>
              <th>Status</th>
            </tr>
          </thead>
          <tbody>
            <tr repeat.for="bid of allBids">
              <td>${bid.auctionNum}</td>
              <td>${bid.bidAmount | ethwei}</td>
              <td>${bid.totalAuctionBidAmount| ethwei}</td>
              <td>${bid.auctionStatus}</td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>
</template>
